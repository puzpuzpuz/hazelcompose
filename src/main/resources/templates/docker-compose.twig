version: '3'
services:
  # hazelcast imdg
  {% for node in [1..membersCount] %}
  hazelcast-{{node}}:
    image: hazelcast/hazelcast
    volumes:
      - ./config:/config
    environment:
      - JAVA_OPTS=-Dhazelcast.config=/config/hazelcast.xml -Dhazelcast.mancenter.url=http://mc:8080/hazelcast-mancenter -Dgroup.name=hz-compose -Dgroup.password=s3crEt
  {% endfor %}
{% if (includeManCenter) %}
  #management center
  mc:
    image: hazelcast/management-center

    # persisting mancenter users db folder to local disk
    volumes:
      - ~/hazelcast-mc:/hazelcast-mc
    environment:
      - MANCENTER_DATA=/hazelcast-mc
      # enable REST interface on management center
      # http://docs.hazelcast.org/docs/latest-development/manual/html/Management/Clustered_REST_via_Management_Center.html
      - JAVA_OPTS=-Dhazelcast.mc.rest.enabled=true
    ports:
      - 8080:{{manCenterExposedPort}}
{% endif %}